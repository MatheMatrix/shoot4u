Original patch available at http://www.spinics.net/lists/kvm/msg78403.html.

This version is ported to Linux kernel 4.0
