Original patch available at http://www.spinics.net/lists/kvm/msg78403.html.

Ported to 4.0.5 Kernel

- ouyang
